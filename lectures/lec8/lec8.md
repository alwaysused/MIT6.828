# Lec8

Interrupt: hardware wants attention.

Traps: interrupt, syscall, exceptions.

`trap` uses `tf->trapno` to tell the interrupt generated, which is pushed onto kernel stack by vector entry. Each vector entry jumps to `alltraps`. 

`tvinit` initializes IDT, so `idt[i]` points to code at `vector[i]`. Interrupts are allowed when syscall happens, but not during device interrupts.

`vectors.S` is generated by `vectors.pl`. Each vector entry first pushes the error word, and then the interrupt number. 

How does the hardware knows which stack to use when interrutp happens? By configuring the per-cpu TSS (task state segment), each CPU can run a different process and take traps at the same time on different kernel stacks.



# HW5 Discussion



# Interrupt

Interrupt introduces concurrency.

Interrupt vs polling. Performance issue.